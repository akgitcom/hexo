{"Asset":[{"_id":"themes\\yilia\\source\\img\\coderwall.png","path":"img/coderwall.png","modified":false},{"_id":"themes\\yilia\\source\\img\\delicious.png","path":"img/delicious.png","modified":false},{"_id":"themes\\yilia\\source\\img\\facebook.png","path":"img/facebook.png","modified":false},{"_id":"themes\\yilia\\source\\img\\github.png","path":"img/github.png","modified":false},{"_id":"themes\\yilia\\source\\img\\google.png","path":"img/google.png","modified":false},{"_id":"themes\\yilia\\source\\img\\img-err.png","path":"img/img-err.png","modified":false},{"_id":"themes\\yilia\\source\\img\\img-loading.png","path":"img/img-loading.png","modified":false},{"_id":"themes\\yilia\\source\\img\\linkedin.png","path":"img/linkedin.png","modified":false},{"_id":"themes\\yilia\\source\\img\\pinboard.png","path":"img/pinboard.png","modified":false},{"_id":"themes\\yilia\\source\\img\\pinterest.png","path":"img/pinterest.png","modified":false},{"_id":"themes\\yilia\\source\\img\\rss.png","path":"img/rss.png","modified":false},{"_id":"themes\\yilia\\source\\img\\stackoverflow.png","path":"img/stackoverflow.png","modified":false},{"_id":"themes\\yilia\\source\\img\\twitter.png","path":"img/twitter.png","modified":false},{"_id":"themes\\yilia\\source\\img\\weibo.png","path":"img/weibo.png","modified":false},{"_id":"themes\\yilia\\source\\js\\instagram.js","path":"js/instagram.js","modified":false},{"_id":"themes\\yilia\\source\\js\\jquery.lazyload.js","path":"js/jquery.lazyload.js","modified":false},{"_id":"themes\\yilia\\source\\js\\main.js","path":"js/main.js","modified":false},{"_id":"themes\\yilia\\source\\js\\script.js","path":"js/script.js","modified":false},{"_id":"themes\\yilia\\source\\css\\style.styl","path":"css/style.styl","modified":false},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":false},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":false},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.svgz","path":"css/fonts/fontawesome-webfont.svgz","modified":false},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":false},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\blank.gif","path":"fancybox/blank.gif","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":false},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":false}],"Cache":[{"_id":"scaffolds\\draft.md","mtime":1420968282000},{"_id":"scaffolds\\post.md","mtime":1420968282000},{"_id":"scaffolds\\page.md","mtime":1420968282000},{"_id":"scaffolds\\photo.md","mtime":1420968282000},{"_id":"source\\_posts\\kaminari简要文档.md","mtime":1420986420000},{"_id":"source\\_posts\\rails-第一天.md","mtime":1420987426000},{"_id":"source\\_posts\\thinkphp-获取搜索引擎蜘蛛.md","mtime":1420985425000},{"_id":"source\\_posts\\thinkphp-ip-黑名单-白名单.md","mtime":1420985459000},{"_id":"themes\\yilia\\README.md","mtime":1420970593000},{"_id":"themes\\yilia\\_config.yml","mtime":1420985310000},{"_id":"themes\\yilia\\package.json","mtime":1420970593000},{"_id":"themes\\yilia\\scripts\\fancybox.js","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\archive.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\category.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\index.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\page.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\layout.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\post.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\tag.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\after-footer.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\archive-post.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\archive.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\article.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\google-analytics.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\footer.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\head.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\mobile-nav.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\header.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\left-col.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\category.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\date.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\duoshuo.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\nav.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\share.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\tag.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\layout\\_partial\\post\\title.ejs","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\coderwall.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\delicious.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\facebook.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\github.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\google.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\img-err.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\img-loading.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\linkedin.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\pinboard.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\pinterest.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\rss.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\stackoverflow.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\twitter.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\img\\weibo.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\js\\instagram.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\js\\jquery.lazyload.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\js\\main.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\js\\script.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_extend.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_variables.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\style.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_util\\grid.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_util\\mixin.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\archive.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\article.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\footer.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\header.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\highlight.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\instagram.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\main.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\mobile.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\page.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\share.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\_partial\\tagcloud.styl","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.eot","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.svg","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.svgz","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.ttf","mtime":1420970593000},{"_id":"themes\\yilia\\source\\css\\fonts\\fontawesome-webfont.woff","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\blank.gif","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_loading@2x.gif","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_loading.gif","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_sprite.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_overlay.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\fancybox_sprite@2x.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\jquery.fancybox.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\jquery.fancybox.css","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\jquery.fancybox.pack.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\fancybox_buttons.png","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-buttons.css","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-media.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-buttons.js","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.css","mtime":1420970593000},{"_id":"themes\\yilia\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.js","mtime":1420970593000}],"Category":[],"Page":[],"Post":[{"title":"kaminari简要文档","date":1420986163000,"tags":["259zkbpdhc8vtg63","u32bt365jj37ixpu","e8kfudjzqwah3h32"],"content":"<h2 id=\"全局参数设置\">全局参数设置</h2>\n<p>执行以下命令，会在config/initializers下生成一个配置文件kaminari_config.rb</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rails g <span class=\"symbol\">kaminari:</span>config</div></pre></td></tr></table></figure>\n\n<p>这个文件控制着kaminari的全局设置，有以下参数可以定义<br><strong>default_per_page</strong> 默认值25<br><strong>page_method_name</strong> 分页方法的名称<br><strong>param_name</strong> 分页参数的参数名，默认为param<br><strong>window / outer_window / left / right</strong>这四个参数都与分页显示有关，设定了显示页码标签的方式和数量。</p>\n<h2 id=\"分页界面定制\">分页界面定制</h2>\n<p>执行一下命令可以获取默认模版文件。目录在app/views/kaminari/下</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">rails g <span class=\"symbol\">kaminari:</span>views default</div></pre></td></tr></table></figure>\n\n<p>各个文件描述如下<br><strong>_paginator.html.erb</strong> 这是总的入口文件，可以通过修改它来调整显示的整体结构比如我不需要”首页”，”末页”这两个链接，那么我就在这个文件里面将对应的代码删除<br><strong>_page.html.erb</strong> 对应页码链接<br><strong>_first_page.html.erb / _last_page.html.erb</strong>对应”首页”和”末页”的链接<br><strong>_prev_page.html.erb / _next_page.html.erb</strong> 对应”上一页”和”下一页”的链接<br><strong>_gap.html.erb</strong> 空隙的显示，默认是中间的省略号(…)</p>\n<blockquote>\n<p>注意，不要修改文件名。</p>\n</blockquote>\n<p>theme功能<br>在<em>app/views/kaminari</em>目录下创建一个文件夹，例如test，把默认的模版文件拷贝进去，修改模版文件的内容，就形成了个性化的样式。<br>view页面按下方写法即可调用个性样式。</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;%= paginate <span class=\"variable\">@blogs</span>, <span class=\"symbol\">:theme=&gt;<span class=\"string\">'test'</span></span> %&gt;</div></pre></td></tr></table></figure>\n\n","source":"_posts/kaminari简要文档.md","raw":"title: kaminari简要文档\ndate: 2015-01-11 22:22:43\ntags: [rails,kaminari,分页]\n---\n##全局参数设置\n执行以下命令，会在config/initializers下生成一个配置文件kaminari_config.rb\n```ruby\nrails g kaminari:config\n```\n这个文件控制着kaminari的全局设置，有以下参数可以定义\n**default_per_page** 默认值25\n**page_method_name** 分页方法的名称\n**param_name** 分页参数的参数名，默认为param\n**window / outer_window / left / right**这四个参数都与分页显示有关，设定了显示页码标签的方式和数量。\n\n##分页界面定制\n执行一下命令可以获取默认模版文件。目录在app/views/kaminari/下\n```ruby\nrails g kaminari:views default\n```\n各个文件描述如下\n**_paginator.html.erb** 这是总的入口文件，可以通过修改它来调整显示的整体结构比如我不需要\"首页\"，\"末页\"这两个链接，那么我就在这个文件里面将对应的代码删除\n**_page.html.erb** 对应页码链接\n**_first_page.html.erb / _last_page.html.erb**对应\"首页\"和\"末页\"的链接\n**_prev_page.html.erb / _next_page.html.erb** 对应\"上一页\"和\"下一页\"的链接\n**_gap.html.erb** 空隙的显示，默认是中间的省略号(…)\n\n>注意，不要修改文件名。\n\ntheme功能\n在*app/views/kaminari*目录下创建一个文件夹，例如test，把默认的模版文件拷贝进去，修改模版文件的内容，就形成了个性化的样式。\nview页面按下方写法即可调用个性样式。\n```ruby\n<%= paginate @blogs, :theme=>'test' %>\n```\n","slug":"kaminari简要文档","updated":1420986420000,"excerpt":"","_id":"12gm1tai3ipwz8i4","categories":[],"comments":true,"layout":"post","photos":[],"link":""},{"title":"thinkphp ip 黑名单&白名单","date":1420985381000,"tags":["a9vljhk9ltdevkr3"],"content":"<p>获取搜素引擎蜘蛛访问情况，入库统计。</p>\n<figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div><div class=\"line\">21</div><div class=\"line\">22</div><div class=\"line\">23</div><div class=\"line\">24</div><div class=\"line\">25</div><div class=\"line\">26</div><div class=\"line\">27</div><div class=\"line\">28</div><div class=\"line\">29</div><div class=\"line\">30</div><div class=\"line\">31</div><div class=\"line\">32</div><div class=\"line\">33</div><div class=\"line\">34</div><div class=\"line\">35</div><div class=\"line\">36</div><div class=\"line\">37</div><div class=\"line\">38</div><div class=\"line\">39</div><div class=\"line\">40</div><div class=\"line\">41</div><div class=\"line\">42</div><div class=\"line\">43</div><div class=\"line\">44</div><div class=\"line\">45</div><div class=\"line\">46</div><div class=\"line\">47</div><div class=\"line\">48</div><div class=\"line\">49</div><div class=\"line\">50</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">is_bot</span><span class=\"params\">()</span></span></div><div class=\"line\">{</div><div class=\"line\">    <span class=\"variable\">$data</span>[<span class=\"string\">'robotspage'</span>] = <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'REQUEST_URI'</span>] ? <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'REQUEST_URI'</span>] : <span class=\"string\">''</span>;</div><div class=\"line\">    <span class=\"variable\">$data</span>[<span class=\"string\">'oldurl'</span>] = <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'HTTP_REFERER'</span>] ? <span class=\"variable\">$_SERVER</span>[<span class=\"string\">'HTTP_REFERER'</span>] : <span class=\"string\">'直接访问'</span>;</div><div class=\"line\">    import(<span class=\"string\">'ORG.Net.IpLocation'</span>); <span class=\"comment\">// 导入IpLocation类</span></div><div class=\"line\">    <span class=\"variable\">$Ip</span> = <span class=\"keyword\">new</span> IpLocation(<span class=\"string\">'UTFWry.dat'</span>); <span class=\"comment\">// 实例化类 参数表示IP地址库文件</span></div><div class=\"line\">    <span class=\"variable\">$data</span>[<span class=\"string\">'robotsip'</span>] = get_client_ip();</div><div class=\"line\">    <span class=\"variable\">$useragent</span> = addslashes(strtolower(<span class=\"variable\">$_SERVER</span>[<span class=\"string\">'HTTP_USER_AGENT'</span>]));</div><div class=\"line\">    <span class=\"keyword\">if</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'googlebot'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Google'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'mediapartners-google'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Google Adsense'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'baiduspider'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Baidu'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'sogou spider'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Sogou'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'sogou web'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Sogou web'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'sosospider'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'SOSO'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'yahoo'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Yahoo'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'msn'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'MSN'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'msnbot'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'msnbot'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'sohu'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Sohu'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'yodaoBot'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Yodao'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'twiceler'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Twiceler'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'ia_archiver'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Alexa_'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'iaarchiver'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'Alexa'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'slurp'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'雅虎'</span>;</div><div class=\"line\">    } <span class=\"keyword\">elseif</span> (strpos(<span class=\"variable\">$useragent</span>, <span class=\"string\">'bot'</span>) !== <span class=\"keyword\">false</span>) {</div><div class=\"line\">    <span class=\"variable\">$bot</span> = <span class=\"string\">'未知'</span>.<span class=\"variable\">$useragent</span>;</div><div class=\"line\">    }</div><div class=\"line\">    <span class=\"variable\">$data</span>[<span class=\"string\">'robotsname'</span>] = <span class=\"variable\">$bot</span>;</div><div class=\"line\">    <span class=\"variable\">$data</span>[<span class=\"string\">'robotsarea'</span>] = serialize(<span class=\"variable\">$Ip</span><span class=\"variable\">-&gt;getlocation</span>(<span class=\"variable\">$data</span>[<span class=\"string\">'robotsip'</span>]));</div><div class=\"line\">    <span class=\"variable\">$data</span>[<span class=\"string\">'create_time'</span>] = time();</div><div class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"keyword\">isset</span>(<span class=\"variable\">$bot</span>)) <span class=\"comment\">//如果是蜘蛛就存到数据库</span></div><div class=\"line\">    {</div><div class=\"line\">        <span class=\"comment\">//$Jrobot-&gt;create();非表单无隐藏域,无法使用create()方法</span></div><div class=\"line\">        <span class=\"variable\">$Jrobot</span> = D(<span class=\"string\">\"Robot\"</span>);</div><div class=\"line\">        <span class=\"variable\">$lastInsId</span> = <span class=\"variable\">$Jrobot</span><span class=\"variable\">-&gt;add</span>(<span class=\"variable\">$data</span>);</div><div class=\"line\">    }</div></pre></td></tr></table></figure>\n\n","source":"_posts/thinkphp-ip-黑名单-白名单.md","raw":"title: thinkphp ip 黑名单&白名单\ndate: 2015-01-11 22:09:41\ntags: php\n---\n获取搜素引擎蜘蛛访问情况，入库统计。\n```php\npublic function is_bot()\n{\n    $data['robotspage'] = $_SERVER['REQUEST_URI'] ? $_SERVER['REQUEST_URI'] : '';\n    $data['oldurl'] = $_SERVER['HTTP_REFERER'] ? $_SERVER['HTTP_REFERER'] : '直接访问';\n    import('ORG.Net.IpLocation'); // 导入IpLocation类\n    $Ip = new IpLocation('UTFWry.dat'); // 实例化类 参数表示IP地址库文件\n    $data['robotsip'] = get_client_ip();\n    $useragent = addslashes(strtolower($_SERVER['HTTP_USER_AGENT']));\n    if (strpos($useragent, 'googlebot') !== false) {\n    $bot = 'Google';\n    } elseif (strpos($useragent, 'mediapartners-google') !== false) {\n    $bot = 'Google Adsense';\n    } elseif (strpos($useragent, 'baiduspider') !== false) {\n    $bot = 'Baidu';\n    } elseif (strpos($useragent, 'sogou spider') !== false) {\n    $bot = 'Sogou';\n    } elseif (strpos($useragent, 'sogou web') !== false) {\n    $bot = 'Sogou web';\n    } elseif (strpos($useragent, 'sosospider') !== false) {\n    $bot = 'SOSO';\n    } elseif (strpos($useragent, 'yahoo') !== false) {\n    $bot = 'Yahoo';\n    } elseif (strpos($useragent, 'msn') !== false) {\n    $bot = 'MSN';\n    } elseif (strpos($useragent, 'msnbot') !== false) {\n    $bot = 'msnbot';\n    } elseif (strpos($useragent, 'sohu') !== false) {\n    $bot = 'Sohu';\n    } elseif (strpos($useragent, 'yodaoBot') !== false) {\n    $bot = 'Yodao';\n    } elseif (strpos($useragent, 'twiceler') !== false) {\n    $bot = 'Twiceler';\n    } elseif (strpos($useragent, 'ia_archiver') !== false) {\n    $bot = 'Alexa_';\n    } elseif (strpos($useragent, 'iaarchiver') !== false) {\n    $bot = 'Alexa';\n    } elseif (strpos($useragent, 'slurp') !== false) {\n    $bot = '雅虎';\n    } elseif (strpos($useragent, 'bot') !== false) {\n    $bot = '未知'.$useragent;\n    }\n    $data['robotsname'] = $bot;\n    $data['robotsarea'] = serialize($Ip->getlocation($data['robotsip']));\n    $data['create_time'] = time();\n    if (isset($bot)) //如果是蜘蛛就存到数据库\n    {\n        //$Jrobot->create();非表单无隐藏域,无法使用create()方法\n        $Jrobot = D(\"Robot\");\n        $lastInsId = $Jrobot->add($data);\n    }\n```","slug":"thinkphp-ip-黑名单-白名单","updated":1420985459000,"excerpt":"","_id":"hbm4jf3rhthja3yv","categories":[],"comments":true,"layout":"post","photos":[],"link":""},{"title":"thinkphp 获取搜索引擎蜘蛛","date":1420985381000,"tags":["a9vljhk9ltdevkr3"],"content":"","source":"_posts/thinkphp-获取搜索引擎蜘蛛.md","raw":"title: thinkphp 获取搜索引擎蜘蛛\ndate: 2015-01-11 22:09:41\ntags: php\n---\n","slug":"thinkphp-获取搜索引擎蜘蛛","updated":1420985425000,"excerpt":"","_id":"kv5s4hoxjhmra6bg","categories":[],"comments":true,"layout":"post","photos":[],"link":""},{"title":"rails 第一天","date":1420985483000,"tags":["259zkbpdhc8vtg63","u32bt365jj37ixpu"],"content":"<p><img src=\"http://7u2icj.com1.z0.glb.clouddn.com/IMG_0242.jpg\" alt=\"野三坡\"></p>\n<h2 id=\"常用命令\">常用命令</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">rake db:schema:dump</div><div class=\"line\">rails g model 名称</div><div class=\"line\">rails g controller 名称</div></pre></td></tr></table></figure>\n\n<h2 id=\"常用gem:\">常用gem:</h2>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div></pre></td><td class=\"code\"><pre><div class=\"line\">gem <span class=\"string\">'mysql2'</span></div><div class=\"line\">gem <span class=\"string\">'kaminari'</span> <span class=\"comment\">#分页</span></div><div class=\"line\">gem <span class=\"string\">'nokogiri'</span> <span class=\"comment\">#DOM分析</span></div></pre></td></tr></table></figure>\n\n<p><a href=\"https://github.com/amatsuda/kaminari\" target=\"_blank\" rel=\"external\">kaminari</a><br><a href=\"http://akgitcom.github.io/2014/09/11/kaminari%E7%AE%80%E8%A6%81%E6%96%87%E6%A1%A3/\" target=\"_blank\" rel=\"external\">kaminari简要文档</a></p>\n<h2 id=\"使用方法：\">使用方法：</h2>\n<p>controller:</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AdminsController</span> <span class=\"inheritance\">&lt; <span class=\"parent\">ApplicationController</span></span></span></div><div class=\"line\">\t<span class=\"function\"><span class=\"keyword\">def</span> </span>index</div><div class=\"line\">\t\t<span class=\"variable\">@admins</span> = <span class=\"constant\">Admin</span>.order(<span class=\"string\">\"id DESC\"</span>).page(params[<span class=\"symbol\">:page</span>]).per(<span class=\"number\">1</span>)</div><div class=\"line\">\t<span class=\"keyword\">end</span></div><div class=\"line\"><span class=\"keyword\">end</span></div></pre></td></tr></table></figure>\n\n<p>views:</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\">&lt;% <span class=\"variable\">@admins</span>.each <span class=\"keyword\">do</span> |b|%&gt;</div><div class=\"line\">&lt;%=b.sbname %&gt;</div><div class=\"line\">&lt;% <span class=\"keyword\">end</span> %&gt;</div><div class=\"line\">&lt;%= paginate <span class=\"variable\">@admins</span> %&gt;</div></pre></td></tr></table></figure>\n\n<p>数据库表名后缀添加方法：<br>在config/application.rb添加</p>\n<figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">config.active_record.table_name_prefix = <span class=\"string\">'j_'</span></div></pre></td></tr></table></figure>\n\n","source":"_posts/rails-第一天.md","raw":"title: rails 第一天\ndate: 2015-01-11 22:11:23\ntags: [rails,kaminari]\n---\n\n![野三坡](http://7u2icj.com1.z0.glb.clouddn.com/IMG_0242.jpg)\n\n##常用命令\n```bash\nrake db:schema:dump\nrails g model 名称\nrails g controller 名称\n```\n\n##常用gem:\n```bash\ngem 'mysql2'\ngem 'kaminari' #分页\ngem 'nokogiri' #DOM分析\n```\n\n[kaminari](https://github.com/amatsuda/kaminari)\n[kaminari简要文档](http://akgitcom.github.io/2014/09/11/kaminari%E7%AE%80%E8%A6%81%E6%96%87%E6%A1%A3/)\n\n##使用方法：\ncontroller:\n```ruby\nclass AdminsController < ApplicationController\n\tdef index\n\t\t@admins = Admin.order(\"id DESC\").page(params[:page]).per(1)\n\tend\nend\n```\nviews:\n```ruby\n<% @admins.each do |b|%>\n<%=b.sbname %>\n<% end %>\n<%= paginate @admins %>\n```\n\n数据库表名后缀添加方法：\n在config/application.rb添加\n```ruby\nconfig.active_record.table_name_prefix = 'j_'\n```\n","slug":"rails-第一天","updated":1420987426000,"excerpt":"","_id":"00ywogigdiaycq6a","categories":[],"comments":true,"layout":"post","photos":[],"link":""}],"Tag":[{"name":"rails","_id":"259zkbpdhc8vtg63","posts":["12gm1tai3ipwz8i4","00ywogigdiaycq6a"]},{"name":"kaminari","_id":"u32bt365jj37ixpu","posts":["12gm1tai3ipwz8i4","00ywogigdiaycq6a"]},{"name":"分页","_id":"e8kfudjzqwah3h32","posts":["12gm1tai3ipwz8i4"]},{"name":"php","_id":"a9vljhk9ltdevkr3","posts":["hbm4jf3rhthja3yv","kv5s4hoxjhmra6bg"]}]}